{% extends "base_generic.html" %}

{% block content %}
{% if search %}
<h4>Your search Results for "{{ search }}"" </h4>
{% else %}
<h4>Recent Posts </h4>
{% endif %}
<p>
{% if page_obj %}
<ul>
  {% for post in page_obj %}
    <li>
        <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
        {% if post.author_id == user.id %}
        (<a href="{% url 'blog:post_update' post.slug }">Edit</a> |
        <a href="{% url 'blog:post_delete' post.slug %}">Delete</a>)
        <br/>
        {% endif %}
        <div style="left:10px">
            {% if post.text|length < 201 %}
                {{ post.text | safe }}
            {% else %}
                {{ post.text|slice:"0:200" | safe }}
                <a href="{{ post.get_absolute_url }}">...</a>
            {% endif %}
        </div>
        <small>
        {% if post.author.username %}
            posted by {{ post.author.username }}
        {% endif %}
        {{ post.natural_updated }}
        </small>
    </li>
  {% endfor %}
</ul>
{% else %}
  {% if search %}
    <p>There are no posts for your search "{{ search }}".</p>
    {% else %}
    <p>There are no posts to display.</p>
    {% endif %}
{% endif %}

</p>
<p>
<a href="{% url 'blog:post_create' %}">Add a Post</a> |
{% if user.is_authenticated %}
<a href="{% url 'logout' %}?next={% url 'blog:all' %}">Logout</a>
{% else %}
<a href="{% url 'login' %}?next={% url 'blog:all' %}">Login</a> |
<a href = "{% url 'userprofile:signup' %}?next={% url 'blog:all' %}">Sign Up</a>
{% endif %}
</p>

<!--Pagination-->
    <div class="pagination">
        <p><span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?page=1">&laquo; <button type="button" class="btn btn-danger">First</button></a>
                <a href="?page={{ page_obj.previous_page_number }}"><button type="button" class="btn btn-danger">Previous</button></a>
            {% endif %}
    
            <span class="page-current">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
            </span>
    
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}"><button type="button" class="btn btn-danger">Next</button></a>
                <a href="?page={{ page_obj.paginator.num_pages }}"><button type="button" class="btn btn-danger">Last</button> &raquo;</a>
            {% endif %}
        </span></p>
    </div>

    <!--Pagination End-->
{% endblock %}
